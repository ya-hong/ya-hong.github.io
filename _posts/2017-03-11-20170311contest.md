---
layout: post
title: 2017-3-11离线赛总结
date: 2017-3-11
tags: NOIP 总结
author: yanghong
header-img: images/cover/0.jpg
---


### Task1
第一题就直接懵逼了……虽然想出这个dp没用多久，但是还是纠结了好久才敢开始写。



<!--more-->




先考虑较小的情况，相邻两个数字对$x$，$y$（$x<y$)交换，会增加一个一个逆序对。那么只需要如此操作小于或等于$k$次，就可以得到需要的序列。

令 $dp[x-1][k]$ 为 $[1,x-1]$的序列经过变换后，还剩下k次操作的方案数。
这时考虑$x$位由于只有前面的序列经过变换，所以x前的所有数字都小于$x$位上的数，那么将x和前一位交换一次，就可以增加一个逆序对。枚举所有的交换次数，所以：
$$dp[x][k]=\sum_{i=max(1,x-k)}^{x}dp[i][k-i]$$
再加上前缀优化就可以过了。

由于这道题卡内存，还需要加上滚动数组优化。但是我根本没注意到，直接就MLE了。

### Task2
第二题相比第一题我感觉反而水一点。-_-||<br>

先拆开公式：
$$
\sum_{i=1}^{m}(x_i-p)^2=\sum_{i=1}^m (xi^2-2p \cdot xi+p^2)
$$
发现值只跟$\sum xi^2$,$\sum xi$有关。
$$
(\sum_{i=1}^m xi^2-2p \cdot xi-p^2)*m\\\
=m \cdot (\sum xi^2)-m \cdot \sum (xi+2p)-p^2 \cdot m^2\\\
=m \cdot (\sum xi^2)-\sum 3xi+\sum xi^2\\\
=m \cdot (\sum xi^2)-2\sum xi
$$
如此就可以不用 double 而用 long long 来储存了。(double 应该会被卡）

按照w（和z）把物品和询问排序，只加入能够研究的点，然后，可以用BIT来直接求和回答询问。

其实写出这个也没有花太久时间（发现可以直接用long long 倒是用了很久）。但是一直怕中间int会溢出，反复看了好几遍

### Task3
这道题其实也不是很难，但是还是没有想出来……

画图可以发现，一个奇数点的到根路径长度加上一个偶数的的到根路径长度，可以直接抵消LCA到根的路径长度。
那么计算路径长度就可以不管LCA了。
然后，把奇数点的路径放在一个数组里，把偶数点的的路径放在一个数组里。那么问题就转变为两个数组数字相加求第k小的问题了。

其实考试的时候也想到了LCA到根的两个距离是相反的，但是就是没想到相加起来会等于0……
然后60分的暴力由于只有1个地方开了 long long 所以只得了5分。



